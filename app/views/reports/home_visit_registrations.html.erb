<div class="row">
  <%= search_form_for @query, url: home_visit_registrations_reports_path do |f| %>
    <div class="modal fade" id="search-form-modal"
         tabindex="-1" role="dialog" aria-labelledby="modal-label" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="modal-label">
              Filtro de <%= HomeVisitRegistration.model_name.human(count: 2)[10..-1][0..16] %>
            </h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true"></span>
            </button>
          </div>
          <div class="modal-body">
            <div class="card-body p-2 o-auto" style="height: 35rem;">
              <%= f.input :handbook_number_eq, as: :integer, required: false, wrapper_html: {class: 'col-lg-12 col-sm-12'} %>
              <div class="col-lg-12">
                <div class="row">
                  <%= f.input :birth_date_gteq, as: :date, html5: true, required: false, label: "#{HomeVisitForm.human_attribute_name :birth_date} de", wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                  <%= f.input :birth_date_lteq, as: :date, html5: true, label: 'até', required: false, wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                </div>
              </div>
              <%= f.input :gender_id_in, as: :select, collection: GenericModel.genders, required: false,
                          wrapper_html: {class: 'col-lg-12 col-sm-12'}, input_html: {class: 'select2-multiple', multiple: true} %>
              <%= f.input :home_type_id_in, as: :select, collection: GenericModel.home_types, required: false,
                          wrapper_html: {class: 'col-lg-12 col-sm-12'}, input_html: {class: 'select2-multiple', multiple: true} %>
              <div class="col-lg-12">
                <div class="row">
                  <%= f.input :weight_monitoring_gteq, as: :integer, required: false, label: "#{HomeVisitForm.human_attribute_name :weight_monitoring} de", wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                  <%= f.input :weight_monitoring_lteq, as: :integer, label: 'até', required: false, wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                </div>
              </div>
              <div class="col-lg-12">
                <div class="row">
                  <%= f.input :height_monitoring_gteq, as: :integer, required: false, label: "#{HomeVisitForm.human_attribute_name :height_monitoring} de", wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                  <%= f.input :height_monitoring_lteq, as: :integer, label: 'até', required: false, wrapper_html: {class: 'col-lg-6 col-sm-12'} %>
                </div>
              </div>
              <%= f.input :out_area_true, as: :boolean, required: false, wrapper_html: {class: 'col-lg-6 col-sm-12 pl-3 mb-3'} %>
            </div>
          </div>
          <div class="modal-footer">
            <%= link_to home_visit_registrations_reports_path, class: 'btn btn-block btn-sm-block btn-danger' do %>
              <i class="fas fa-redo-alt mr-2"></i><span class="btn-title"><%= t("helpers.actions.clear") %></span>
            <% end %>
            <%= button_tag class: 'btn btn-block btn-sm-block btn-primary',
                           data: {disable_with: '<i class="fas fa-spinner fa-spin"></i>Pesquisando...'.html_safe} do %>
              <i class="fas fa-search mr-2"></i><span class="btn-title"><%= t("helpers.actions.search") %></span>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <div class="col-lg-12">
    <div class="row">
      <div class="col-lg-12">
        <% content_for :table_header do %>
          <thead>
          <tr>
            <th><%= FamilyMember.human_attribute_name :name %></th>
            <th><%= FamilyMember.human_attribute_name :social_name %></th>
            <th><%= FamilyMember.human_attribute_name :cns_number %></th>
            <th><%= FamilyMember.human_attribute_name :birth_date %></th>
            <th><%= FamilyMember.human_attribute_name :city %></th>
            <th><%= FamilyMember.human_attribute_name :handbook_number %></th>
          </tr>
          </thead>
        <% end %>
        <% content_for :table_body do %>
          <tbody>
          <% @list.each do |home_visit_registration| %>
            <tr>
              <td><%= home_visit_registration&.family_member&.name %></td>
              <td><%= home_visit_registration&.family_member&.social_name %></td>
              <td><%= home_visit_registration&.family_member&.cns_number %></td>
              <td><%= home_visit_registration&.family_member&.birth_date&.strftime('%d/%m/%Y') %></td>
              <td><%= home_visit_registration&.family_member&.city.name %></td>
              <td><%= home_visit_registration&.family_member&.family&.handbook_number %></td>
            </tr>
          <% end %>
          </tbody>
        <% end %>
        <%= render template: 'reports/table', locals: {model: HomeVisitRegistration} %>
      </div>
      <div class="col-lg-12">
        <div class="card">
          <div class="card-header p-4">
            <h3 class="mb-0">
              <i class="fas fa-map mr-2"></i>Mapa de Localização
            </h3>
          </div>
          <div id="family_member_map" class="card-body p-0">
            <%= render 'application/map' %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

