<%= simple_form_for @family do |f| %>
  <% content_for :body do %>
    <%= f.input :responsible_birth_date, html5: true, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <%= f.input :responsible_cns_number, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <%= f.input :handbook_number, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <%= f.input :members_quantity, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <%= f.input :family_income, as: :string, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {class: 'money', disabled: show?(f.object.persisted?)} %>
    <%= f.input :reside_since, html5: true, wrapper_html: {class: 'col-lg-3 col-sm-12'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <%= f.input :moving, wrapper_html: {class: 'col-lg-12 col-sm-12 pl-3 mb-3'}, input_html: {disabled: show?(f.object.persisted?)} %>
    <div class="col-12">
      <div class="card card-collapsed mb-3">
        <div class="card-header">
          <h3 class="card-title">
            <i class="fas fa-user mr-2"></i><%= FamilyMember.model_name.human(count: 2) %>
          </h3>
          <div class="card-options">
            <a href="#" class="card-options-collapse badge bg-blue-deep text-white px-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
          </div>
        </div>
        <% if @family.family_members.map(&:persisted?).any? %>
          <div class="table-responsive">
            <table class="table table-hover table-outline table-vcenter text-nowrap card-table">
              <thead>
              <tr>
                <th>#</th>
                <th><%= FamilyMember.human_attribute_name :name %></th>
                <th><%= FamilyMember.human_attribute_name :cns_number %></th>
                <th><%= FamilyMember.human_attribute_name :birth_date %></th>
                <th><%= FamilyMember.human_attribute_name :responsible %></th>
                <th>Ações</th>
              </tr>
              </thead>
              <tbody>
              <% @family.family_members.each_with_index do |family_member, index| %>
                <tr>
                  <td><%= index = index + 1 %></td>
                  <td><%= family_member.name %></td>
                  <td><%= family_member.cns_number %></td>
                  <td><%= family_member.birth_date.strftime('%d/%m/%Y') %></td>
                  <td><%= family_member.responsible ? 'SIM' : 'NÃO' %></td>
                  <td class="text-center">
                    <%= render 'application/table_links', f: family_member %>
                  </td>
                </tr>
              <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="card-body">
            <div class="alert alert-warning alert-dismissible p-4 text-center" role="alert">
              <div class="row">
                <div class="col pt-2 py-auto font-weight-bold">
                  <i class="fas fa-exclamation-triangle mr-2"></i>Nenhum Membro Familiar incluído.
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <% if @family&.home_registration&.persisted? %>
      <div class="col-12">
        <div class="card card-collapsed mb-3">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-home mr-2"></i><%= HomeRegistration.model_name.human(count: 2) %>
            </h3>
            <div class="card-options">
              <a href="#" class="card-options-collapse badge bg-blue-deep text-white px-2" data-toggle="card-collapse"><i class="fe fe-chevron-up"></i></a>
            </div>
          </div>
          <div class="card-body pb-4">
            <%= f.simple_fields_for :home_registration do |home_registration| %>
              <%= render 'application/home_registration_fields', f: home_registration  %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
  <%= render template: 'application/form', locals: {form: @family} %>
<% end %>
