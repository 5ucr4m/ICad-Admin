<% GenericModel.app_modules.order(:reference).each do |app_module| %>
  <% if current_user.permissions.by_app_module(app_module).any? %>
    <li class="nav-item dropdown">
      <a href="javascript:void(0)" class="nav-link <%= "active" if controller_name != 'dashboards' && Permission.where(app_module: app_module).map(&:model_reference).include?(controller_name.singularize.camelcase) %> py-4" data-toggle="dropdown" aria-expanded="false">
        <%= app_module.name.html_safe %>
      </a>
      <div class="dropdown-menu dropdown-menu-arrow" x-placement="bottom-start">
        <% current_user.permissions.by_app_module(app_module).each do |permission| %>
          <%= link_to send("#{permission.model_reference.camelcase.underscore.pluralize}_path"), class: 'dropdown-item' do %>
            <i class="<%= t("activerecord.models.#{permission.model_reference.camelcase.underscore}.icon") %> dropdown-icon"></i><%= permission.model_reference.constantize.model_name.human(count: 2) %>
          <% end %>
        <% end %>
      </div>
    </li>
  <% end %>
<% end %>
